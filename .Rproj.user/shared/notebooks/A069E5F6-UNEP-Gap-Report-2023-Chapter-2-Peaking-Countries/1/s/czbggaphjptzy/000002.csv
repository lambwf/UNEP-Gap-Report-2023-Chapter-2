"0",""
"0",""
"0","fsi <- openxlsx::read.xlsx('Data/FSI-2023-DOWNLOAD.xlsx')"
"0","fsi <- fsi %>% "
"0","  mutate(iso=countrycode(Country,""country.name"",""iso3c""))"
"2","Warnung:"
"2"," [38;5;232mThere was 1 warning in `mutate()`.[39m
[38;5;232m[36mi[38;5;232m In argument: `iso = countrycode(Country, ""country.name"", ""iso3c"")`.[39m
Caused by warning in `countrycode_convert()`:
[33m![39m Some values were not matched unambiguously: Micronesia
"
"0","fsi$Rank <- gsub(""st"","""",fsi$Rank)"
"0","fsi$Rank <- gsub(""nd"","""",fsi$Rank)"
"0","fsi$Rank <- gsub(""rd"","""",fsi$Rank)"
"0","fsi$Rank <- gsub(""th"","""",fsi$Rank)"
"0","fsi$Rank <- as.numeric(fsi$Rank)"
"0",""
"0","data_peaking <- left_join(data_peaking,fsi %>% select(iso,fsi_rank=Rank),by=""iso"")"
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(excluded=ifelse(fsi_rank>50,0,1)) %>% "
"0","  mutate(excluded=ifelse(iso==""UKR"",0,excluded))"
"0",""
"0",""
"0","# exclude countries with growth rates above or near 0"
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(rate_CO2_peak=rate_CO2_peak*100) %>% "
"0","  mutate(rate_GHG_peak=rate_GHG_peak*100) %>% "
"0","  mutate(excluded=ifelse(rate_CO2_peak<0,excluded,1))"
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(excluded=ifelse(abs(rate_CO2_peak)>0.1,excluded,1))"
"0",""
"0",""
"0","# calculate absolute and relative reductions since peak"
"0",""
"0","rates_CO2 <- rates_CO2 %>% "
"0","  group_by(country) %>% "
"0","  summarise(percent_reduction_CO2_peak=((first(CO2)-last(CO2))/first(CO2))*100,"
"0","            absolute_reduction_CO2_peak=first(CO2)-last(CO2),"
"0","            CO2_peak=first(CO2))"
"0",""
"0","rates_GHG <- rates_GHG %>% "
"0","  group_by(country) %>% "
"0","  summarise(percent_reduction_GHG_peak=((first(GHG)-last(GHG))/first(GHG))*100,"
"0","            absolute_reduction_GHG_peak=first(GHG)-last(GHG),"
"0","            GHG_peak=first(GHG))"
"0",""
"0","data_peaking <- left_join(data_peaking,rates_CO2,by = ""country"")"
"0","data_peaking <- left_join(data_peaking,rates_GHG,by = ""country"")"
"0",""
"0",""
"0","# exclude countries with growing GHG emissions since the same CO2 peak year"
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(excluded=ifelse(rate_GHG_peak<0,excluded,1))"
"0",""
"0",""
"0","# exclude countries with emissions growing since 2012"
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(excluded=ifelse(rate_GHG_2012<0,excluded,1))"
"0",""
"0",""
"0","# exclude small countries with large oil industries and therefore large yearly emissions variations"
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(excluded=ifelse(country==""Equatorial Guinea"",1,excluded)) %>% "
"0","  mutate(excluded=ifelse(country==""Timor-Leste"",1,excluded)) %>% "
"0","  mutate(excluded=ifelse(country==""Trinidad and Tobago"",1,excluded)) %>% "
"0","  mutate(excluded=ifelse(country==""Gabon"",1,excluded))"
"0",""
"0",""
"0",""
"0","included_countries <- data_peaking %>% "
"0","  ungroup() %>% "
"0","  filter(excluded==0) %>% "
"0","  select(iso,country,peak_year,rate_CO2_peak,rate_GHG_peak,rate_GHG_2012) %>% "
"0","  distinct()"
"0",""
"0","excluded <- data_peaking %>% "
"0","  ungroup() %>% "
"0","  filter(excluded==1) %>% "
"0","  select(iso,country,peak_year,rate_CO2_peak,rate_GHG_peak,rate_GHG_2012) %>% "
"0","  distinct()"
"0",""
"0",""
"0","data_peaking <- data_peaking %>% "
"0","  mutate(country=ifelse(iso==""MKD"",""North Macedonia"",country))"
"0",""
"0",""
"0",""
"0","included_countries <- left_join(included_countries,country_aggregations %>% select(iso,EU,Annex1),by=""iso"")"
"0","included_countries <- included_countries %>% "
"0","  group_by(EU,Annex1) %>% "
"0","  summarise(n=n(),countries=paste0(country,collapse=""; ""))"
"1","[38;5;232m`summarise()` has grouped output by 'EU'. You can override using the `.groups` argument.[39m
"
